Description: fix use-after-free vulnerabilities
Origin: backport, https://gcc.gnu.org/git/?p=gcc.git;a=commit;h=be3004dc350a820a5b0320b34bd05673ba534058
Bug: https://gcc.gnu.org/bugzilla/show_bug.cgi?id=70481

Index: valgrind-3.12.0~svn20160714/coregrind/m_demangle/cplus-dem.c
===================================================================
--- valgrind-3.12.0~svn20160714.orig/coregrind/m_demangle/cplus-dem.c	2017-06-07 15:02:29.755632207 -0400
+++ valgrind-3.12.0~svn20160714/coregrind/m_demangle/cplus-dem.c	2017-06-07 15:03:33.404287436 -0400
@@ -1250,11 +1250,13 @@ squangle_mop_up (struct work_stuff *work
     {
       free ((char *) work -> btypevec);
       work->btypevec = NULL;
+      work->bsize = 0;
     }
   if (work -> ktypevec != NULL)
     {
       free ((char *) work -> ktypevec);
       work->ktypevec = NULL;
+      work->ksize = 0;
     }
 }
 
